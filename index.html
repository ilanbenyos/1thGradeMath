<html>
  <head>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<style>
#container{
    max-width:600px;
    border:1px solid black;
    position:relative;
    margin:auto;
    background-image: linear-gradient(#c983c7, #b7e3a8);
    transition:0.4s all;
}
.margin-left-lg{
    margin-left:3em;
}
.header{
    font-size:3em;
}
.flex{
  display: flex;
}
.row{
  flex-direction: row;
}
.col{
  flex-direction: column;
}
.center{
    justify-content: center;
}
.center-ver{
    align-items: center;
}
.lastExam{
  background-image: linear-gradient(to bottom, #3498db, #7cb4d6);
  /*background-color: lightblue;*/
  border-bottom: 3px solid black;
}
.border-bottom{
  border-bottom: 3px solid black;
}
.field{
    margin:.3em;
    /*border:1px solid green;*/
    font-size:1.2em;
    /*width:4em;*/
}
.line{
    display:flex;
    flex-direction: row;
}
.width5{
    width:5em;
}
.width3{
    width:3em;
}
.margin-sm{
    margin-left:1em;
}
.icon{
    width:1.5em;
    height:1.5em;
    width:60px;
    /*height:90px;*/
    overflow: hidden;
    /*outline:1px solid red;*/
    margin-left:20px;
}
.img-icon{
    /*width:100%;*/
    max-height:100%;
    margin:auto;
  display:block;
}
.danger{
    background-color: red;
}
.margin-left-sm{
    margin-left:2em;
}
.text-align-center{
    text-align:center;
}
input{
    font-size: 1.3em;
    text-align: right;
    background-color: #9bf4f7;
    transition: 0.2s;
}
.fade-enter-active, .fade-leave-active {
  transition: opacity .5s
}
.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {
  opacity: 0
}
.self-align-end{
    align-self: flex-end;
}
.width10{
    width:10em;
}
.width100-per{
    width:100%;
}
.right-top{
position: absolute;
    /*background: red;*/
    /*color: white;*/
    top: 5px;
    right: 5px;    
}
.checkbox-pnl{
    flex-flow: row wrap;
    margin-top:25px;
}
.bottom-pnl{
        /*margin-top:1em;
        margin-bottom:1em;*/
}
.btn {
  background-image: linear-gradient(to bottom, #3498db, #7cb4d6);
  -webkit-border-radius: 13;
  -moz-border-radius: 13;
  border-radius: 13px;
  font-family: Arial;
  color: #ffffff;
  font-size: 20px;
  padding: 10px 20px 10px 20px;
  text-decoration: none;
    margin-left: 15px;
    margin-top: 10px;

}

.btn:hover {
  background: #70bded;
  background-image: linear-gradient(to bottom, #70bded, #3498db);
  text-decoration: none;
}
.lg-hide{
    display:none;
}
.sm-hide{
    display:initial;
}
.settings{
    /*margin-top:25px;
    margin-bottom:25px;*/
    flex-flow: row wrap;
}
.crl1-hover:hover{
    background-color: #9affd2;
    transition:0.3s;
}
input[type=checkbox]{
        transform: scale(2);
        margin-right:15px;
}
input[type=checkbox]:hover{
    cursor :pointer;
}

input:focus { 
    background-color: #8bcbd6;
    /*background-image: linear-gradient(#8bcbd6, #0fdbc0);*/
    transition: 0.5s;
}
.margin-top-1em{
    /*margin-top:1em;*/
}

input[type="checkbox"]:checked + label:after {
  font-weight: bold;
}
.space-around{
    justify-content:  space-around ; 
}
@media  screen and (max-device-width: 480px) {
    #container{
        max-width:initial;
    }
    .header{
        margin-bottom:25px;
        font-size: 84px;
    }
    input{
        /*font-size:68px;*/
    }
    input[type=checkbox]{
        transform: scale(5);
        margin-right:25px;
    }
    .translate-label-sm{
        transform: translate(-38%,-38%);
    }
    .icon{
        width:60px;
        height:initial;
    }
    .img-icon{
        width:100%;
    }
    .btn-sm{
        font-size:70px;
        margin-bottom:25px;
        margin-left: 70px;
    }

    .sm-margin-left{
        margin-left:20px;
    }
    .btn-top-right-sm{
        width:5em;
        height:5em;
    }
    .text-align-right-sm{
        text-align: end;
    }
    .col1-rev{
        flex-direction: column-reverse;
    }
    .width-sm-100-per{
        width:100%;
    }
    .width-sm-90-per{
        width:90%;
    }
    .field{
        margin:auto;
        font-size:58px;
        width:90%;
        margin-bottom:25px;
    }
    .col1{
        flex-direction: column;
    }
    .font-size-md-1{
        font-size:3em;
    }
    .sm-margin-top{
        margin-bottom:25px;
    }
    .sm-space-around{
        justify-content: space-around 
   }
   .sm-margin-top-sm{
       margin-top:25px;
   }
   .margin-left-sm0{
       margin-left:initial;
   }
    .sm-hide{
        display:none;
    }
    .lg-hide{
        display:initial;
    }

}
*{
    /*outline:1px solid red;*/
}
</style>
  </head>
  <body>
<div id="container">
    <div class="border-bottom">
        <button class="btn right-top btn-top-right-sm" @click="isSettings=!isSettings">
            <img :src= "settingsPng" alt="settings" height="30" width="30">
        </button>
        <h1 class="header text-align-center">התרגילים של {{studentName}}</h1>
    </div>
    <!--=======================SETTINGS AREA============================-->
    <transition name="fade">
        <div v-if="isSettings" class="settings flex col center border-bottom ">
            <div  class="settings flex row center col1">
                <div  class="field flex row center font-size-md-1 col1-rev width-sm-100-per">
                    <input   class="width5 width-sm-100-per" v-model="studentName"  placeholder="שם התלמיד" :bind="studentName"> </input>
                    <div class=" text-align-right-sm">:שם התלמיד </div>
                </div>
            <!--<div  class=" flex row center col1-rev ">-->
                <div  class="field flex row center font-size-md-1 col1-rev width-sm-100-per">
                    <input   class="width3 width-sm-100-per" v-model="maxNum" placeholder="עד מספר"  :bind="maxNum"> </input>
                    <div class=" text-align-right-sm">:עד מספר </div>
                </div>
                
                <div  class="field flex row center font-size-md-1 col1-rev width-sm-100-per">
                    <input   class="width3 width-sm-100-per" v-model="minNum" placeholder="ממספר"  :bind="minNum"> </input>
                    <div class=" text-align-right-sm">:ממספר </div>
                </div>
            </div>
            <div class="bottom-pnl field flex col center">
                <div class="checkbox-pnl flex row center">
                    <div class="margin-sm  flex row col1-rev" v-for="(operator,idx) in operators">
                        <input type="checkbox" id="operator.bul" v-model="operator.bul">
                                <label class="translate-label-sm" for="operator.name">{{ operator.name }}</label>
                    </div>
                </div>    
                <button class="btn margin-sm btn-sm " @click="initGame">התחל</button>
                    <button v-if="exams.length>0" class="btn btn-sm" @click="delHist">
                        <i class="material-icons md-48">delete</i></button>
            </div>
        </div>
    </transition >
    <!--=======================EXAMS AREA============================-->
    <transition name="fade">
        <div v-if="isGameOn" class="field flex col center sm-space-around sm-margin-top-sm ">
            <div class=" flex row center ">
                <div class=" flex row center ">
                    <div class="field">{{currNum2}}</div>
                    <div class="field">{{currOperator.id}}</div>
                    <div class="field">{{currNum1}}</div>
                    <div class="field">=</div>
                </div>
                <input  @keyup.enter="checkExam " class="input width3 res-input" v-model="res" autofocus></input>
            </div>
        <!--===========NUMBERS KEYBOARD=============-->
            <div class=" flex row center checkbox-pnl margin-top-line">
                <div  :class="numbers" v-for="(number,idx) in numbers">
                    <button class="btn btn-sm" @click="numberBtn(idx)">{{idx}}</button>
                </div>
            </div>
            <div class=" flex row center checkbox-pnl margin-top-line">
                    <button class="btn btn-sm" @click="deletLast">
                        <i class="material-icons md-48">undo</i></button>
                    <button class="btn btn-sm" @click="initRes">
                        <i class="material-icons md-48">delete</i></button>
                    <button class="btn btn-sm" @click="checkExam">
                        <i class="material-icons md-48">done</i></button>
            </div>
        </div>
    </transition>
        <div class="field flex row center col1">
            <div class=" flex row center ">
                <div class="field">{{answers.currects}} :נכון</div>
                <div class="field">{{answers.wrongs}} :לא נכון</div>
                <div class="field">{{answers.wrongs+answers.currects}} :סך הכל</div>
            </div>
        </div>

        <div  :class="[ idx==0  ? 'lastExam border-bottom': 'crl1-hover', 'field flex row space-around ']" 
                v-for="(exam,idx) in exams">
            <!--<transition name="fade">-->
                <div class="field" >{{exams.length - idx}}: </div>
                <div class="field" > {{exam.num2}}{{exam.operator.id}}{{exam.num1}} = {{exam.currectRes}} </div>
                <div v-if="exam.resBul" class="flex row center center-ver">
                    <div class="icon">
                        <img class="img-icon" :src= "vPng" alt="wrong" >
                    </div>
                </div>
                <div v-else class="flex row center center-ver">
                        {{exam.enterdrRes}}
                    <div class="icon">
                        <img class="img-icon" :src= "xPng" alt="wrong" >
                    </div>
                </div>
            <!--</transition>-->
      </div>
</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.2/vue.min.js"></script>
    
<script>

new Vue({

    el: '#container',
    name: 'Grading',
  data() {
    return {
      studentName:'הגר',
      isGameOn:false,
      isSettings:true,
      settingsPng:'https://image.flaticon.com/icons/png/512/22/22377.png',
      vPng:'https://vignette4.wikia.nocookie.net/sims/images/0/06/Icon_yes_check_v.svg/revision/latest?cb=20100731224125',
      xPng:'https://openclipart.org/image/2400px/svg_to_png/16155/milker-X-icon.png',
      exams:[],
      minNum:20,
      maxNum:50,
      currNum1:0,
      currNum2:0,
      currOperator:'',
      res:null,
      numbers:[0,1,2,3,4,5,6,7,8,9],
      operators:[{id:'+',bul:true, name:'חיבור'},{id:'-',bul:true, name:'חיסור'},
                {id:'X',bul:false, name:'כפל'},{id:'/',bul:false, name:'חילוק'}],
      answers:{currects:0, wrongs:0},
   }
  },
  created () {
    // this.creatExam()
  },
  methods: {
      initRes(){
          this.res= null;
        document.getElementsByClassName("res-input")[0].focus();
      },
      deletLast(){
          this.res= Math.floor(this.res/10);
        document.getElementsByClassName("res-input")[0].focus();
      },
      numberBtn(idx){
        this.res*=10;
        this.res+=idx;
        document.getElementsByClassName("res-input")[0].focus();

      },
      delHist(){
        this.exams= [];
        this.currNum1=0;
        this.currNum2=0;
        this.answers={currects:0, wrongs:0};
        this.isSettings =false;
        this.initGame();
        document.getElementsByClassName("res-input")[0].focus();
      },
      initGame(){
            this.creatExam();
            this.isGameOn=true;
            this.isSettings =false;
      },
    getRandNum(min,max){
      var rand=  Math.floor(Math.random()*(max-min+1)+min);
      return rand;
    },
    getOperator(){
       var operatorsOpt = this.operators.filter((op)=>{return op.bul===true })
       return operatorsOpt[this.getRandNum(0,operatorsOpt.length-1)]
    },
    creatExam(){
       var num1 = this.getRandNum(this.minNum,this.maxNum);
       var num2 = this.getRandNum(this.minNum,this.maxNum);
       var operatorsOpt = this.operators.filter((op)=>{return op.bul===true });
       this.currOperator = this.getOperator();
       console.log(this.currOperator.id);
       this.currNum1 =num1;
       this.currNum2 =num2;
       if(num1>num2){
          this.currNum2 =num1;
          this.currNum1 =num2;
       }
      //  this.res = num1-num2;
       },
       getCorrectAnswer(num1,num2){
            switch(this.currOperator.id){
                case '+':
                    return num2+num1
                break;
                case '-':
                    return num2-num1
                break;
                case '/':
                    return num2/num1
                break;
                case 'X':
                    return num2*num1
                break;
            }
       },
       checkExam(){
          document.getElementsByClassName("res-input")[0].focus();
           if(!this.res || isNaN(this.res)) return;
         var num1=this.currNum1;
         var num2=this.currNum2;
         var currectRes = this.getCorrectAnswer(this.currNum1,this.currNum2);
         var enterdrRes = +this.res;
         var resBul = true;
         var operator = this.currOperator
          var obj = {num1,num2,enterdrRes,resBul,operator,currectRes}
         //===============CHECK IF RES IS CURRECT==================
         if(enterdrRes ==currectRes){
                this.answers.currects++ ;
                 this.resolveExam(obj)
          }else{
               this.answers.wrongs++;
               obj.resBul=false;
                this.resolveExam(obj)
          }
          
    },
    resolveExam(obj){
          this.exams.unshift(obj);
          this.res = null;
          this.creatExam();
    }
  },
})
</script>
    
  </body>
</html>